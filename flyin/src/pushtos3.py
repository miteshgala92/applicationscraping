import json
from flyin.src import utils

with open('flyin_flights_properties', 'r') as json_file:
    data = json.load(json_file)

utils = utils.Utils()
oneway_flights = [{'extraction_source': 'flyin', 'extraction_date': '2020-11-11', 'travel_type': 'Domestic', 'origin': 'JED', 'destination': 'RUH', 'journey_type': 'oneway', 'departure_date': '2020-11-14', 'return_date': 'NA', 'airline': 'Saudia', 'currency': 'SAR', 'base_price': '492.00', 'taxes_and_fees': '55.00', 'other_fees': '15.00', 'vat': '84.30', 'total_price': '646.30'}, {'extraction_source': 'flyin', 'extraction_date': '2020-11-11', 'travel_type': 'Domestic', 'origin': 'JED', 'destination': 'RUH', 'journey_type': 'oneway', 'departure_date': '2020-11-14', 'return_date': 'NA', 'airline': 'Flynas', 'currency': 'SAR', 'base_price': '389.00', 'taxes_and_fees': '110.00', 'other_fees': '15.00', 'vat': '77.10', 'total_price': '591.10'}, {'extraction_source': 'flyin', 'extraction_date': '2020-11-11', 'travel_type': 'Domestic', 'origin': 'JED', 'destination': 'RUH', 'journey_type': 'oneway', 'departure_date': '2020-11-14', 'return_date': 'NA', 'airline': 'Flyadeal', 'currency': 'SAR', 'base_price': '475.24', 'taxes_and_fees': '65.55', 'other_fees': '15.00', 'vat': '83.37', 'total_price': '639.16'}, {'extraction_source': 'flyin', 'extraction_date': '2020-11-11', 'travel_type': 'Domestic', 'origin': 'JED', 'destination': 'RUH', 'journey_type': 'oneway', 'departure_date': '2020-11-18', 'return_date': 'NA', 'airline': 'Saudia', 'currency': 'SAR', 'base_price': '239.00', 'taxes_and_fees': '55.00', 'other_fees': '15.00', 'vat': '46.35', 'total_price': '355.35'}, {'extraction_source': 'flyin', 'extraction_date': '2020-11-11', 'travel_type': 'Domestic', 'origin': 'JED', 'destination': 'RUH', 'journey_type': 'oneway', 'departure_date': '2020-11-18', 'return_date': 'NA', 'airline': 'Flynas', 'currency': 'SAR', 'base_price': '172.00', 'taxes_and_fees': '110.00', 'other_fees': '15.00', 'vat': '44.55', 'total_price': '341.55'}, {'extraction_source': 'flyin', 'extraction_date': '2020-11-11', 'travel_type': 'Domestic', 'origin': 'JED', 'destination': 'RUH', 'journey_type': 'oneway', 'departure_date': '2020-11-18', 'return_date': 'NA', 'airline': 'Flyadeal', 'currency': 'SAR', 'base_price': '247.46', 'taxes_and_fees': '34.10', 'other_fees': '15.00', 'vat': '44.48', 'total_price': '341.04'}, {'extraction_source': 'flyin', 'extraction_date': '2020-11-11', 'Type': 'Domestic', 'origin': 'AHB', 'destination': 'RUH', 'journey_type': 'oneway', 'departure_date': '2020-11-14', 'airline': 'Saudia', 'currency': 'SAR', 'base_price': 'NA', 'taxes_and_fees': 'NA', 'other_fees': 'NA', 'vat': 'NA', 'total_price': 'NA'}, {'extraction_source': 'flyin', 'extraction_date': '2020-11-11', 'travel_type': 'Domestic', 'origin': 'AHB', 'destination': 'RUH', 'journey_type': 'oneway', 'departure_date': '2020-11-14', 'return_date': 'NA', 'airline': 'Flynas', 'currency': 'SAR', 'base_price': '470.00', 'taxes_and_fees': '110.00', 'other_fees': '15.00', 'vat': '89.25', 'total_price': '684.25'}, {'extraction_source': 'flyin', 'extraction_date': '2020-11-11', 'travel_type': 'Domestic', 'origin': 'AHB', 'destination': 'RUH', 'journey_type': 'oneway', 'departure_date': '2020-11-14', 'return_date': 'NA', 'airline': 'Flyadeal', 'currency': 'SAR', 'base_price': '578.77', 'taxes_and_fees': '79.90', 'other_fees': '15.00', 'vat': '101.05', 'total_price': '774.72'}, {'extraction_source': 'flyin', 'extraction_date': '2020-11-11', 'travel_type': 'Domestic', 'origin': 'AHB', 'destination': 'RUH', 'journey_type': 'oneway', 'departure_date': '2020-11-18', 'return_date': 'NA', 'airline': 'Saudia', 'currency': 'SAR', 'base_price': '536.00', 'taxes_and_fees': '55.00', 'other_fees': '15.00', 'vat': '90.90', 'total_price': '696.90'}, {'extraction_source': 'flyin', 'extraction_date': '2020-11-11', 'travel_type': 'Domestic', 'origin': 'AHB', 'destination': 'RUH', 'journey_type': 'oneway', 'departure_date': '2020-11-18', 'return_date': 'NA', 'airline': 'Flynas', 'currency': 'SAR', 'base_price': '319.00', 'taxes_and_fees': '110.00', 'other_fees': '15.00', 'vat': '66.60', 'total_price': '510.60'}, {'extraction_source': 'flyin', 'extraction_date': '2020-11-11', 'travel_type': 'Domestic', 'origin': 'AHB', 'destination': 'RUH', 'journey_type': 'oneway', 'departure_date': '2020-11-18', 'return_date': 'NA', 'airline': 'Flyadeal', 'currency': 'SAR', 'base_price': '402.75', 'taxes_and_fees': '55.61', 'other_fees': '15.00', 'vat': '71.00', 'total_price': '544.36'}, {'extraction_source': 'flyin', 'extraction_date': '2020-11-11', 'travel_type': 'Domestic', 'origin': 'JED', 'destination': 'DMM', 'journey_type': 'oneway', 'departure_date': '2020-11-14', 'return_date': 'NA', 'airline': 'Saudia', 'currency': 'SAR', 'base_price': '623.00', 'taxes_and_fees': '65.00', 'other_fees': '15.00', 'vat': '105.45', 'total_price': '808.45'}, {'extraction_source': 'flyin', 'extraction_date': '2020-11-11', 'travel_type': 'Domestic', 'origin': 'JED', 'destination': 'DMM', 'journey_type': 'oneway', 'departure_date': '2020-11-14', 'return_date': 'NA', 'airline': 'Flynas', 'currency': 'SAR', 'base_price': '572.00', 'taxes_and_fees': '110.00', 'other_fees': '15.00', 'vat': '104.55', 'total_price': '801.55'}, {'extraction_source': 'flyin', 'extraction_date': '2020-11-11', 'travel_type': 'Domestic', 'origin': 'JED', 'destination': 'DMM', 'journey_type': 'oneway', 'departure_date': '2020-11-14', 'return_date': 'NA', 'airline': 'Flyadeal', 'currency': 'SAR', 'base_price': '651.26', 'taxes_and_fees': '89.84', 'other_fees': '15.00', 'vat': '113.42', 'total_price': '869.52'}, {'extraction_source': 'flyin', 'extraction_date': '2020-11-11', 'travel_type': 'Domestic', 'origin': 'JED', 'destination': 'DMM', 'journey_type': 'oneway', 'departure_date': '2020-11-18', 'return_date': 'NA', 'airline': 'Saudia', 'currency': 'SAR', 'base_price': '456.00', 'taxes_and_fees': '65.00', 'other_fees': '15.00', 'vat': '80.40', 'total_price': '616.40'}, {'extraction_source': 'flyin', 'extraction_date': '2020-11-11', 'travel_type': 'Domestic', 'origin': 'JED', 'destination': 'DMM', 'journey_type': 'oneway', 'departure_date': '2020-11-18', 'return_date': 'NA', 'airline': 'Flynas', 'currency': 'SAR', 'base_price': '323.00', 'taxes_and_fees': '110.00', 'other_fees': '15.00', 'vat': '67.20', 'total_price': '515.20'}, {'extraction_source': 'flyin', 'extraction_date': '2020-11-11', 'travel_type': 'Domestic', 'origin': 'JED', 'destination': 'DMM', 'journey_type': 'oneway', 'departure_date': '2020-11-18', 'return_date': 'NA', 'airline': 'Flyadeal', 'currency': 'SAR', 'base_price': '475.24', 'taxes_and_fees': '65.55', 'other_fees': '15.00', 'vat': '83.37', 'total_price': '639.16'}, {'extraction_source': 'flyin', 'extraction_date': '2020-11-11', 'Type': 'Domestic', 'origin': 'GIZ', 'destination': 'RUH', 'journey_type': 'oneway', 'departure_date': '2020-11-14', 'airline': 'Saudia', 'currency': 'SAR', 'base_price': 'NA', 'taxes_and_fees': 'NA', 'other_fees': 'NA', 'vat': 'NA', 'total_price': 'NA'}, {'extraction_source': 'flyin', 'extraction_date': '2020-11-11', 'travel_type': 'Domestic', 'origin': 'GIZ', 'destination': 'RUH', 'journey_type': 'oneway', 'departure_date': '2020-11-14', 'return_date': 'NA', 'airline': 'Flynas', 'currency': 'SAR', 'base_price': '393.00', 'taxes_and_fees': '110.00', 'other_fees': '15.00', 'vat': '77.70', 'total_price': '595.70'}, {'extraction_source': 'flyin', 'extraction_date': '2020-11-11', 'travel_type': 'Domestic', 'origin': 'GIZ', 'destination': 'RUH', 'journey_type': 'oneway', 'departure_date': '2020-11-14', 'return_date': 'NA', 'airline': 'Flyadeal', 'currency': 'SAR', 'base_price': '620.21', 'taxes_and_fees': '85.56', 'other_fees': '15.00', 'vat': '108.12', 'total_price': '828.89'}, {'extraction_source': 'flyin', 'extraction_date': '2020-11-11', 'travel_type': 'Domestic', 'origin': 'GIZ', 'destination': 'RUH', 'journey_type': 'oneway', 'departure_date': '2020-11-18', 'return_date': 'NA', 'airline': 'Saudia', 'currency': 'SAR', 'base_price': '511.00', 'taxes_and_fees': '65.00', 'other_fees': '15.00', 'vat': '88.65', 'total_price': '679.65'}, {'extraction_source': 'flyin', 'extraction_date': '2020-11-11', 'travel_type': 'Domestic', 'origin': 'GIZ', 'destination': 'RUH', 'journey_type': 'oneway', 'departure_date': '2020-11-18', 'return_date': 'NA', 'airline': 'Flynas', 'currency': 'SAR', 'base_price': '277.00', 'taxes_and_fees': '110.00', 'other_fees': '15.00', 'vat': '60.30', 'total_price': '462.30'}, {'extraction_source': 'flyin', 'extraction_date': '2020-11-11', 'travel_type': 'Domestic', 'origin': 'GIZ', 'destination': 'RUH', 'journey_type': 'oneway', 'departure_date': '2020-11-18', 'return_date': 'NA', 'airline': 'Flyadeal', 'currency': 'SAR', 'base_price': '495.94', 'taxes_and_fees': '68.45', 'other_fees': '15.00', 'vat': '86.91', 'total_price': '666.30'}, {'extraction_source': 'flyin', 'extraction_date': '2020-11-11', 'Type': 'Domestic', 'origin': 'AHB', 'destination': 'DMM', 'journey_type': 'oneway', 'departure_date': '2020-11-14', 'airline': 'Saudia', 'currency': 'SAR', 'base_price': 'NA', 'taxes_and_fees': 'NA', 'other_fees': 'NA', 'vat': 'NA', 'total_price': 'NA'}, {'extraction_source': 'flyin', 'extraction_date': '2020-11-11', 'travel_type': 'Domestic', 'origin': 'AHB', 'destination': 'DMM', 'journey_type': 'oneway', 'departure_date': '2020-11-14', 'return_date': 'NA', 'airline': 'Flynas', 'currency': 'SAR', 'base_price': '632.00', 'taxes_and_fees': '110.00', 'other_fees': '15.00', 'vat': '113.55', 'total_price': '870.55'}, {'extraction_source': 'flyin', 'extraction_date': '2020-11-11', 'travel_type': 'Domestic', 'origin': 'AHB', 'destination': 'DMM', 'journey_type': 'oneway', 'departure_date': '2020-11-14', 'return_date': 'NA', 'airline': 'Flyadeal', 'currency': 'SAR', 'base_price': '754.80', 'taxes_and_fees': '104.19', 'other_fees': '15.00', 'vat': '131.10', 'total_price': '1005.09'}, {'extraction_source': 'flyin', 'extraction_date': '2020-11-11', 'travel_type': 'Domestic', 'origin': 'AHB', 'destination': 'DMM', 'journey_type': 'oneway', 'departure_date': '2020-11-18', 'return_date': 'NA', 'airline': 'Saudia', 'currency': 'SAR', 'base_price': '748.00', 'taxes_and_fees': '65.00', 'other_fees': '15.00', 'vat': '124.20', 'total_price': '952.20'}, {'extraction_source': 'flyin', 'extraction_date': '2020-11-11', 'travel_type': 'Domestic', 'origin': 'AHB', 'destination': 'DMM', 'journey_type': 'oneway', 'departure_date': '2020-11-18', 'return_date': 'NA', 'airline': 'Flynas', 'currency': 'SAR', 'base_price': '294.00', 'taxes_and_fees': '110.00', 'other_fees': '15.00', 'vat': '62.85', 'total_price': '481.85'}, {'extraction_source': 'flyin', 'extraction_date': '2020-11-11', 'travel_type': 'Domestic', 'origin': 'AHB', 'destination': 'DMM', 'journey_type': 'oneway', 'departure_date': '2020-11-18', 'return_date': 'NA', 'airline': 'Flyadeal', 'currency': 'SAR', 'base_price': '413.14', 'taxes_and_fees': '57.00', 'other_fees': '15.00', 'vat': '72.77', 'total_price': '557.91'}]
filename = utils.writeToFile(oneway_flights, data.get('output_location'), 'flyin')
journey_type = "oneway"
utils.saveToS3(filename,journey_type)